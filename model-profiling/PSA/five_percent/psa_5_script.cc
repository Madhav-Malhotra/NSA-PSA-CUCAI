/**
 * @author: Akira Yoshiyama
 * @date: 28/02/2024
 * @description: Positive Selection Algorithm for Network Attack Detection with 100 detectors
*/

/**
 * Params to be hardcoded by user:
 *      Class Detectors: num_detectors, num_features, array_ capacity, array_
 *      float* scaler(): mean, std_dev, mean length, std_dev length
 *      bool psa(): radius
 *      int main(): dummy attack vector length
*/

/** 
 * @brief       I       nterface for detectors array
*/
class Detectors {
    public:
        Detectors();
        ~Detectors();
        float get(short, short);
        unsigned short get_num_dtrs() {
            return num_detectors;
        }
        unsigned short get_num_feats() {
            return num_features;
        }

    private:
        // Harcoded
        unsigned short num_detectors{100};
        unsigned short num_features{24};
        // num_detectors * num_features
        float detectorsArray_[2400]{-4.880319, 1.3629826, -0.18915486, 1.9758674, -0.22134511, -0.2428783, 0.0040365043, -0.24347694, 0.18033509, -0.4140556, -0.3628318, -0.1833188, -0.090107955, -0.090107955, -0.49794924, -0.20792872, 10.653706, -0.0983583, -0.20809601, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 0.2952493, 6.9252443, 1.1017035, 10.839559, 4.872946, 0.14330162, 11.18844, 1.6707468, 3.4484744, 3.9621668, 8.628297, -0.09093443, -0.09093443, 1.3101336, 10.119657, 2.2005422, 9.810256, 10.1208935, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 0.8907637, 2.9488938, 1.3982396, 2.7927132, 1.0537764, 0.020731889, 2.7784386, 0.6302707, 3.4484744, 0.7438518, 1.8453373, -0.09045487, -0.09045487, 1.912828, 3.277727, 9.821305, 1.1218358, 3.2780333, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 3.3491075, 6.8057394, 4.308, 14.803495, 7.1516137, 0.036417667, 10.45682, 0.6583917, 3.4484744, 4.962041, 3.9656842, -0.09016918, -0.09016918, -0.49794924, 15.183916, 5.831528, 24.770529, 15.18584, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 4.321138, 5.0628195, 6.065594, 16.098263, 8.376646, 0.21747391, 7.2172155, 1.1505088, 3.4484744, 4.3192234, -0.16755947, -0.09062833, -0.09062833, 1.6114807, 17.609613, -0.16749138, 38.021107, 17.611866, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 0.22689614, 3.821583, 0.30476284, 3.0969262, 5.7518725, -0.017156702, 4.211029, 0.067851186, 3.4484744, 2.3085213, -0.1833188, -0.08999572, -0.08999572, 2.5155222, 3.3601217, -0.16749138, 1.0799209, 3.3604393, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.888971, 1.7491657, 1.0374858, 3.9126186, 1.563066, 3.4044805, 0.12956445, 0.6083216, 4.004788, 3.8776443, 1.2809359, -0.1833188, -0.090546705, -0.090546705, 1.3101336, 1.9103806, -0.2248982, 0.46437004, 1.9261334, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 2.2596939, 4.8386846, 3.146567, 5.309107, 2.8468194, 0.1673024, 5.99889, 0.5177868, 3.4484744, 2.117809, 5.022992, -0.0908324, -0.0908324, 1.0087864, 4.690788, 2.3871145, 2.1499977, 4.691286, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, -4.880319, 0.14636202, 4.36934, 0.34491876, 5.1105, 3.2943559, -0.02188089, 5.030072, 0.40530288, 3.4484744, 1.8703676, 1.9971998, -0.057181474, -0.057181474, -0.49794924, 6.783848, 1.5260113, 4.3893757, 6.7846303, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, 4.889276, 0.07006711, 0.33205333, 1.8801109, 0.09184347, -0.053679336, 0.26611987, 0.012194567, 4.215695, 3.8776443, 0.25392696, -0.26927876, -0.091056876, -0.091056876, -0.49794924, 0.17014484, 5.013479, -0.086593196, 0.16959836, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, -4.880319, 4.712992, 4.562486, 6.893424, 2.543881, 3.7431343, 0.1574775, 5.22427, 1.7129283, 1.3026245, 2.249947, 6.0401855, -0.09063853, -0.09063853, -0.49794924, 1.1857116, 2.2005422, 0.30622494, 1.1857337, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 0.06656014, 2.4873934, 0.2120953, 3.6499712, 3.953447, -0.017995443, 2.4462657, 0.081911676, 2.5901344, 1.4180703, -0.1833188, -0.09007735, -0.09007735, 2.5155222, 4.416839, 4.6546865, 2.4380426, 4.4173, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 7.893136, 4.2494903, 10.6557255, 5.309107, 1.8884046, 0.2373068, 5.0558343, 2.4018922, 3.4484744, 1.5237652, 3.5043652, -0.090618126, -0.090618126, -0.49794924, 5.7666225, 7.065776, 3.3460217, 5.767267, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 4.6748915, 5.6345735, 5.7443466, 5.309107, 3.953447, 0.068424515, 7.6262455, 0.9114804, 3.0193045, 2.9207063, 7.077436, -0.09031203, -0.09031203, 2.5155222, 4.5412297, 5.860231, 2.3159738, 4.541708, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.889019, 0.31378365, 1.3776813, 0.5086314, 3.7412543, -0.09963357, 0.0958197, 0.780699, 0.011609232, 3.8776443, 1.3169106, -0.2635481, -0.091056876, -0.091056876, -0.49794924, 3.5817392, 2.4086423, 1.0893091, 3.5747657, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, -4.880319, -0.085897125, -0.011859708, 0.6167435, -0.01700866, -0.1058436, 0.18791343, -0.16167769, 1.502021, 3.4484744, -0.30856225, -0.26856247, -0.09109769, -0.09109769, -0.49794924, 0.08154932, 1.59777, -0.089604855, 0.08142137, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, -4.880319, 3.5262918, 4.8969874, 4.8547387, 5.032584, 5.7647066, 0.067452766, 5.903987, 0.70057315, 3.4484744, 2.5951276, 2.9506395, -0.09048548, -0.09048548, 0.10474502, 4.8744884, 2.315356, 2.3037715, 4.875012, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.8892593, 0.7863349, 3.2602582, 0.86076796, 2.543881, 1.5555469, -0.01422004, 3.0136998, 0.11003265, 3.8776443, 4.451707, -0.1833188, -0.08952636, -0.08952636, 2.5155222, 3.996764, 8.221088, 1.3555604, 3.9954336, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, 4.888929, 5.417329, 4.7132173, 5.0153623, 5.1105, 5.5365915, -0.014562237, 5.4636908, 0.25063753, 3.8776443, 8.153644, -0.1833188, -0.082312524, -0.082312524, -0.49794924, 7.8766117, 1.9493872, 5.2746663, 7.8812428, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, -4.880319, -0.14415094, 0.60954815, 0.08544968, 0.08878796, 0.012147006, 0.15644364, 0.19008453, 0.34906092, 3.4484744, -0.1770393, 0.15192524, -0.0911283, -0.0911283, -0.49794924, 0.05875247, 1.8848044, -0.09085608, 0.05862143, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, -4.880319, 4.8079257, 0.610651, 6.8007565, 1.9908358, 0.980912, 0.17247018, 0.33584023, 0.9677224, 1.7317944, 0.08562224, -0.2262988, -0.09072016, -0.09072016, -0.49794924, 2.1349347, 5.6736584, 1.0305538, 2.1350858, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.888911, 0.8784024, 4.33292, 1.1665708, 7.521288, 8.21063, 0.037382156, 4.843792, 0.12409314, 3.8776443, 7.390104, -0.1833188, -0.08939371, -0.08939371, 1.6114807, 6.657489, 3.685945, 4.023337, 6.6549873, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, 4.8891287, 2.6283116, 1.0001686, 5.657857, 2.543881, -0.06320137, 0.27540275, 0.46351913, 5.748288, 3.8776443, 0.88021755, -0.1833188, -0.09089362, -0.09089362, -0.49794924, 2.196047, 3.4993727, 0.37972417, 2.1917064, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 1.608948, 0.78244716, 2.6708739, 1.5502712, 1.4926187, 0.13819274, 0.47929582, 1.6566863, 3.4484744, 0.20446175, -0.26927876, -0.09075077, -0.09075077, 0.7074393, 1.786184, 2.925304, 0.6616418, 1.7862878, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 0.0137145175, -0.16069685, 1.3210167, -0.088430926, -0.2420503, 0.4558537, -0.22991091, 3.0767958, 3.4484744, -0.3536075, -0.29793212, -0.09108748, -0.09108748, -0.49794924, -0.016681187, -0.19619493, -0.09460376, -0.016822478, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, 4.889154, 9.143022, 2.5494323, 12.654255, 8.074332, -0.2478463, 0.22955622, 2.0505176, 2.5143762, 3.8776443, 3.0649893, -0.2262988, -0.0905365, -0.0905365, -0.49794924, 6.8240366, 7.2667, 3.9849143, 6.8114085, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 1.1076696, -0.18915486, 1.7843544, -0.22134511, -0.2428783, 0.025791477, -0.24347694, 0.30687946, -0.4140556, -0.3628318, -0.1833188, -0.09062833, -0.09062833, -0.49794924, -0.20792872, 11.887953, -0.0983583, -0.20809601, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.8890977, -0.13970315, 1.5978326, -0.031929184, 2.2679312, 3.0923226, -0.02122833, 1.073446, 0.095972165, 3.8776443, 1.9414715, -0.1833188, -0.08973043, -0.08973043, 2.5155222, 2.9402192, 3.535252, 0.89280534, 2.9344435, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 0.24936113, 0.95289963, 0.52716494, 0.9993266, 2.2800508, 0.0044946535, 0.59135514, 0.12409314, 3.4484744, 0.27448943, -0.19191477, -0.090852804, -0.090852804, -0.49794924, 1.4500356, 2.8894248, 0.39229757, 1.4500935, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 8.845428, 5.350089, 12.017939, 5.032584, 5.7518725, 0.19946805, 6.8034053, 1.9660171, 3.4484744, 3.0876658, 8.114687, -0.09043446, -0.09043446, 2.5155222, 3.2070405, 1.030877, 0.9854149, 3.2073374, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.8889427, -0.050927453, 0.10226527, 0.80207855, 0.061288483, -0.184504, 0.17378958, -0.10958749, 1.8816543, 3.8776443, 0.078780875, -0.31512412, -0.09067935, -0.09067935, -0.49794924, 0.08658161, 1.9350357, -0.09122699, 0.08598092, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, 4.8890452, -0.0410758, -0.12532832, 0.7804562, -0.049473334, -0.20561811, 0.3489836, -0.21683109, 1.8394728, 3.8776443, -0.072266795, -0.29793212, -0.09109769, -0.09109769, -0.49794924, -0.036251806, -0.45452577, -0.09592774, -0.036693584, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, -4.880319, 0.85226315, -0.19043621, 1.3395503, -0.22134511, -0.2453623, 0.009129616, -0.244003, 0.22251655, 0.4442844, -0.36329302, -0.19191477, -0.0905365, -0.0905365, -0.49794924, -0.20562698, 8.988906, -0.09835612, -0.20579395, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.8888845, 0.41017947, -0.114584476, 0.72485566, -0.08384769, -0.17208394, 0.0051444066, -0.2121473, 0.22251655, 3.0193045, -0.06108236, -0.20910677, -0.090760976, -0.090760976, 1.0087864, -0.08754465, 2.164663, -0.09686897, -0.087765984, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 1.5567999, 0.2126361, 2.5720284, 0.37829643, 0.5640118, 0.06586821, -0.030736987, 1.2208111, 3.4484744, -0.20444313, -0.1833188, -0.09078138, -0.09078138, 0.85811275, 0.4241373, -0.016798431, -0.01739317, 0.42405593, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, 4.8887334, 5.907335, 0.63062716, 6.871802, 2.555339, 1.5952911, -0.014051884, 0.2705765, 1.6426258, 1.7317944, 0.7373179, -0.097358786, -0.07988411, -0.07988411, 2.5155222, 2.0178592, 9.534271, 0.71627355, 2.0079892, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 1.4206802, 4.2209125, 1.7441986, 2.543881, 5.1523976, -0.013173475, 4.6102786, 0.18033509, 3.4484744, 2.1972148, 0.8539319, -0.08843459, -0.08843459, 2.5155222, 2.9318175, 1.0380533, 0.8285222, 2.9320772, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.889146, -0.08162967, 0.16525133, 0.62292135, 0.032643188, -0.13730776, 0.09395678, -0.078715995, 1.5160815, 3.8776443, 0.12559414, -0.26927876, -0.091056876, -0.091056876, -0.49794924, 0.067548014, 4.7120934, -0.092110135, 0.06701186, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, -4.880319, 4.1187077, 4.7946925, 5.3798547, 3.9264941, 5.7518725, 0.07802734, 5.650045, 0.9536619, 2.1609645, 2.6424403, 3.9656842, -0.09043446, -0.09043446, 2.5155222, 2.4421198, 1.0380533, 0.87695587, 2.4423127, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.888993, 2.1742318, 3.8447778, 2.8994536, 8.074332, 2.754497, 0.031434532, 3.9171839, 0.5037263, 3.8776443, 5.8200536, -0.2262988, -0.090414055, -0.090414055, 2.5155222, 8.80156, 8.221088, 6.587665, 8.789085, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, 4.8892846, 0.24117169, 0.32399812, 1.5248853, 1.3083138, 1.6756077, 0.14531769, 0.05362356, 2.8518279, 3.8776443, 0.39724937, -0.1833188, -0.09049568, -0.09049568, 0.7074393, 1.0290453, 0.9806462, 0.2537556, 1.0193366, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, 4.8890967, -0.13533792, 0.8802208, -0.06590728, 1.2619084, 2.3053048, -0.021124657, 0.46102288, -0.0727537, 3.8776443, 0.94886166, -0.2262988, -0.09072016, -0.09072016, -0.49794924, 0.6201662, 6.0037484, -0.041753575, 1.1114155, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, 4.8888497, 14.472407, 5.612485, 19.922478, 5.309107, 6.950823, 0.3936896, 7.3359976, 3.5829732, 3.8776443, 10.743208, 10.189188, -0.0905263, -0.0905263, -0.49794924, 3.7597082, -0.16749138, 1.1963868, 3.7534466, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 6.8182955, 3.5824406, 9.021688, 2.2782435, 4.600119, 0.1825275, 3.7052486, 1.4739, 3.4484744, 1.8961573, 0.22499122, -0.090546705, -0.090546705, 1.912828, 3.246325, 2.4158182, 0.9970955, 3.2466273, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 5.828958, 4.492287, 8.752953, 2.543881, 3.3982704, 0.16706757, 5.106322, 3.4704895, 1.3026245, 2.1525924, 6.0401855, -0.09043446, -0.09043446, 2.214175, 1.3409959, 2.2435973, 0.40136617, 1.3410391, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 0.31846827, 1.0825261, 0.69087756, 0.7579421, 1.2508413, 0.008137496, 0.55907476, 0.43342388, 3.4484744, 0.041999053, 0.19060719, -0.09092423, -0.09092423, -0.49794924, 0.8635298, 2.0570252, 0.08938941, 0.8635082, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, 4.889153, 1.1240376, -0.030501725, 1.6082861, 0.11915199, 0.024153074, 0.011684894, -0.17210822, 0.15221411, 3.8776443, 0.006485547, -0.24778877, -0.09067935, -0.09067935, -0.49794924, 0.09951013, 3.241042, -0.087139316, 0.098063156, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, -4.880319, -0.14219539, 0.24265997, 0.14413913, 0.07121885, 0.060171247, 0.51809657, -0.034734074, 0.5318473, 3.4484744, -0.24625988, -0.15681449, -0.09108748, -0.09108748, 0.7074393, 0.15316404, 2.3942902, -0.08554802, 0.15304583, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, 4.8889465, 0.014598863, 0.6862497, 0.87003475, 1.1288033, -0.15510985, 0.0645884, 0.2350815, 1.9660171, 3.8776443, 0.55682945, -0.2262988, -0.09045487, -0.09045487, 1.912828, 1.0703274, 1.0739325, 0.036563154, 1.0680553, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 3.9178917, 0.41127098, 5.339699, 0.2814753, -0.03794724, 0.102296986, 0.06841709, 0.86929905, 3.4484744, -0.21674217, -0.1790208, -0.09073036, -0.09073036, -0.3472757, 0.43043038, 5.946341, -0.060558796, 0.43034986, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, -4.880319, 4.4012747, -0.1835216, 6.1767955, -0.2104599, -0.21928018, 0.09254345, -0.24110964, 1.1223878, 0.015114399, -0.360641, -0.1833188, -0.09049568, -0.09049568, -0.49794924, -0.19724947, 10.52454, -0.09826458, -0.1974153, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 0.9085136, -0.057453815, 1.5712191, -0.13540922, -0.101289585, 0.1076005, -0.18354365, 0.81305707, 1.7317944, -0.31647974, -0.1833188, -0.09022019, -0.09022019, 1.3101336, -0.08365842, 7.02272, -0.09580249, -0.0838088, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 0.11592489, 0.26621452, 2.2075362, 0.48810342, 0.13303564, 0.17449446, -0.0005218061, 5.045264, 2.5901344, -0.19237468, -0.19621281, -0.09078138, -0.09078138, 0.7074393, 0.5618738, 2.2435973, -0.01102988, 0.5618112, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 7.789144, -0.056496453, 11.208642, -0.08384769, -0.2010641, 0.34143057, -0.18505876, 3.9063642, 3.0193045, -0.33219948, -0.1833188, -0.090771176, -0.090771176, 1.6114807, -0.043273494, 5.7095375, -0.09551118, -0.043418396, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.8888717, 0.54775065, 4.1585712, 0.8298788, 8.074332, 2.4671795, 0.028251214, 4.4526606, 0.12409314, 3.8776443, 6.520253, -0.21197212, -0.09031203, -0.09031203, 1.0087864, 6.67697, 1.2030977, 3.8065498, 6.6754036, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, 4.8887935, 1.3193325, 1.2098182, 2.1086907, 2.9796712, 3.4616127, 0.034694463, 0.7390646, 0.5599683, 3.8776443, 1.4671896, -0.2262988, -0.090699755, -0.090699755, -0.49794924, 2.6297584, 1.1743941, 0.8239731, 2.6378782, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 0.44933623, 0.068482496, 1.2407049, -0.034959704, -0.18077798, 0.1599829, -0.12278404, 1.445779, 3.4484744, -0.31770965, -0.21053945, -0.091005854, -0.091005854, -0.19660212, 0.038236722, -0.19619493, -0.09278861, 0.03810289, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, 4.8892064, 0.54760504, 7.0604715, 0.91945744, 16.370012, 2.2369945, 0.012744676, 10.887406, 0.2787585, 3.8776443, 15.352967, 3.0373156, -0.09068955, -0.09068955, -0.49794924, 13.199687, 4.704917, 14.6893215, 13.197632, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 1.9975712, 0.08031705, 2.816053, -0.018918347, -0.19899409, 0.026794663, -0.114533044, 0.47560537, 3.4484744, -0.3220912, -0.10738747, -0.09038345, -0.09038345, -0.49794924, 0.021914585, 8.242617, -0.093391255, 0.021778526, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.8888817, 1.8014941, 1.3476938, 4.1041317, 2.5496101, 1.0264522, 0.3121787, 0.77409613, 4.4547234, 3.8776443, 1.3465052, -0.26927876, -0.09093443, -0.09093443, 0.10474502, 2.8970413, 2.1861908, 0.6973133, 2.9101331, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, 4.889189, 12.960253, 4.4128737, 17.667568, 8.074332, 4.5462985, 0.3820678, 4.9280553, 3.1049168, 3.8776443, 7.275491, -0.29793212, -0.0905365, -0.0905365, 2.214175, 7.1200566, 1.0380533, 4.332494, 7.1045465, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, 4.8892713, 2.8176615, 4.3270273, 3.9651303, 5.309107, 1.001198, 0.050201245, 4.7691593, 0.6583917, 3.8776443, 6.888648, -0.105238445, -0.09043446, -0.09043446, -0.49794924, 5.3815346, 8.39331, 2.4836543, 5.386498, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 0.4897119, 1.8117672, 0.77736723, 3.1973755, 0.5884379, 0.060980897, 1.3664533, 0.33500046, 3.4484744, 0.33652282, -0.27500945, -0.09075077, -0.09075077, -0.3472757, 4.09919, -0.16749138, 1.6466842, 4.0996084, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, 4.8888474, 2.6889381, -0.07974261, 3.5543044, 0.01278246, -0.184918, 0.1247849, -0.19663963, 0.6162102, 3.8776443, -0.041211687, -0.29793212, -0.090842605, -0.090842605, -0.3472757, 0.0658217, 4.202607, -0.09214669, 0.06493641, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, 4.889263, 1.1264017, 5.325589, 1.3827951, 5.309107, 7.550298, -0.011403472, 6.721046, 0.1662746, 3.8776443, 9.90841, 10.189188, -0.08932229, -0.08932229, 2.5155222, 3.0552335, -0.16749138, 0.7887825, 3.0486624, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, -0.15528674, -0.06751584, -0.016484596, -0.073153436, -0.11784967, -0.014045338, -0.18847276, 0.12409314, 2.1609645, -0.32047695, -0.1833188, -0.09093443, -0.09093443, 1.6114807, -0.0460258, 3.298449, -0.09375706, -0.046171095, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, 4.8887815, -0.14229535, 0.19312464, 0.10398319, 0.2213202, 0.010905018, 0.011756731, -0.06431309, 0.3912424, 3.8776443, 0.15049969, -0.26927876, -0.09094463, -0.09094463, 1.15946, 0.21297109, 2.2866523, -0.08321713, 0.2118654, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, 4.8888445, -0.1646669, 0.10094301, -0.09370754, -0.06475083, -0.12902771, 0.12307136, -0.111991495, -0.016511744, 3.8776443, 0.079549566, -0.26927876, -0.09103647, -0.09103647, 0.7074393, -0.0026529517, 6.3768926, -0.09489394, -0.0023755122, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, -4.880319, 5.8941197, 3.5619023, 8.21857, 5.3969526, 5.918301, 0.19537804, 4.0149584, 1.9097753, 3.4484744, 2.391309, 0.50292856, -0.09064874, -0.09064874, -0.49794924, 6.101486, 2.5736868, 4.6007004, 6.102176, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 0.51762205, 0.06100815, 1.0615476, -0.08384769, -0.15717988, 0.010145228, -0.1299929, 0.46154487, 3.4484744, -0.3049494, -0.2005108, -0.090842605, -0.090842605, -0.49794924, -0.037822418, 4.611632, -0.09557968, -0.037966583, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, -4.880319, -0.1104589, -0.23470563, 0.32947418, -0.1567977, -0.23791029, 0.098599344, -0.26130396, 0.89742, 3.4484744, -0.3665215, -0.29220146, -0.09107728, -0.09107728, -0.49794924, -0.11126528, -0.7343844, -0.09696006, -0.11141943, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, 4.889107, 0.12215659, 3.8045275, 0.2460734, 5.309107, 2.148398, -0.016308125, 3.8578653, 0.025669722, 3.8776443, 5.661549, -0.29793212, -0.090414055, -0.090414055, 1.912828, 5.1148834, 4.3461246, 2.2314544, 5.1140947, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, 4.8891325, 0.8999809, -0.0074654417, 1.19746, 0.06892723, -0.2428783, -0.012229779, -0.16376197, 0.13815363, 3.8776443, 0.0011431393, -0.2262988, -0.08941412, -0.08941412, 2.5155222, 0.06593871, 11.816195, -0.092160545, 0.06526519, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, 4.889077, 0.018390467, 0.982747, 0.15958372, 2.543881, -0.15635185, 0.15698726, 0.4527595, 0.5037263, 3.8776443, 0.8526985, -0.29793212, -0.090842605, -0.090842605, -0.045928534, 2.0955133, -0.19619493, 0.33986953, 2.0912044, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, 4.889031, 3.5144086, 2.1964087, 5.129652, 5.4699025, 5.8711057, 0.068399735, 1.7669523, 1.558263, 3.8776443, 3.051845, -0.26927876, -0.09038345, -0.09038345, 2.214175, 4.833844, -0.16749138, 2.3755298, 4.821716, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, -0.037162516, 0.6289833, 1.157304, 0.40655977, 0.0854254, 0.1526994, 0.22193792, 2.7252836, 3.4484744, -0.1853796, 0.010091216, -0.09102626, -0.09102626, -0.49794924, 0.53371084, -0.798967, -0.047251012, 0.5336443, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, -4.880319, 2.238576, -0.1493591, 3.1434782, -0.002495032, 0.23156816, 0.05459897, -0.2146803, 0.5599683, 3.4484744, -0.3243204, -0.29793212, -0.09022019, -0.09022019, 2.214175, 0.041827306, 9.476864, -0.059175365, 0.041693956, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.8890047, 3.8894818, 3.3239775, 5.10803, 10.839559, -0.25281435, 0.18108901, 3.1222885, 0.79899657, 3.8776443, 4.548024, -0.29793212, -0.09050589, -0.09050589, 1.912828, 8.905863, 9.419457, 6.7545595, 8.890265, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 0.32715964, 0.021216378, 2.3558042, -0.099316165, -0.11370965, 0.36086157, -0.14813092, 4.6234493, 3.4484744, -0.30210525, -0.1833188, -0.09097525, -0.09097525, 0.10474502, -0.04943895, 0.837129, -0.09582834, -0.0495847, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, -0.06741496, 0.46913043, 0.66925514, 0.3756229, 0.044439156, 0.062716685, 0.09996756, 1.6004443, 3.4484744, -0.18910775, -0.17257379, -0.09092423, -0.09092423, 1.0087864, 0.49114335, 2.0929043, -0.049947772, 0.49107108, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, -4.880319, 0.027388195, -0.18915486, 0.15031695, -0.22134511, -0.2428783, -0.01600329, -0.24347694, 0.067851186, -0.4140556, -0.3628318, -0.1833188, -0.090556905, -0.090556905, 2.5155222, -0.20792872, 11.816195, -0.0983583, -0.20809601, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 0.56760824, 4.7316556, 1.9357114, 6.7432814, 4.3318453, 0.12337831, 5.827194, 2.8658884, 3.4484744, 2.8150883, 0.90407526, -0.090618126, -0.090618126, 1.0087864, 7.597588, 0.5500946, 5.717718, 7.598482, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.889086, 7.057336, 3.2819655, 10.149143, 2.543881, 0.52219766, 0.21185672, 3.0561626, 2.5987391, 3.8776443, 4.4660816, -0.1833188, -0.09051609, -0.09051609, 2.214175, 4.1095314, 8.242617, 1.4346557, 4.107376, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, 4.889002, 0.79222107, 0.3074106, 1.0893478, 0.47358978, -0.03297923, -0.011469127, 0.009529281, 0.15221411, 3.8776443, 0.24585572, -0.1833188, -0.08983246, -0.08983246, 2.5155222, 0.5256717, 12.103229, -0.053921737, 0.5491454, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 0.71786004, 5.3130274, 0.91945744, 5.032584, 5.7518725, -0.014082379, 6.728233, 0.095972165, 3.4484744, 3.0320125, 7.077436, -0.089454934, -0.089454934, 2.5155222, 3.3601217, 1.030877, 1.0799209, 3.3604393, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.8892293, 1.4045143, 2.6374357, 1.9480671, 5.309107, -0.2428783, 0.008137513, 2.1629705, 0.2787585, 3.8776443, 3.2208033, -0.29793212, -0.090261005, -0.090261005, 2.5155222, 6.202046, 11.887953, 3.2911859, 6.191117, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, 4.8889737, 4.2716713, 1.8933226, 5.6084347, 5.309107, 2.8157694, 0.08111835, 1.3127764, 0.75681514, 3.8776443, 2.1901429, -0.29793212, -0.090465076, -0.090465076, -0.49794924, 4.9179893, 4.819731, 2.0621839, 4.9232936, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, 4.8887362, 1.1764857, 0.40300635, 3.5790155, 0.886273, -0.073965415, 0.22532465, 0.05313078, 8.968141, 3.8776443, 0.31492254, -0.29793212, -0.09094463, -0.09094463, -0.49794924, 0.8209547, 0.2630602, -0.011177727, 0.8189883, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, 4.888988, 0.35446787, -0.1234168, 0.6105657, -0.049473334, -0.16835791, -0.008124787, -0.2140305, 0.18033509, 3.8776443, -0.06534858, -0.2262988, -0.090465076, -0.090465076, -0.49794924, -0.051748805, 7.0083685, -0.09633438, -0.04905882, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 2.403629, 3.5397363, 4.607625, 4.4967265, 2.541286, 0.27570802, 3.6761258, 4.0750904, 3.4484744, 1.6241945, 0.04877323, -0.090771176, -0.090771176, 0.4060922, 5.496178, 3.8868694, 2.91989, 5.496786, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 0.017395306, 0.23309985, 1.0337473, 0.035316736, -0.076449454, 1.866149, -0.03927157, 2.5424972, 3.4484744, -0.26305577, -0.18188615, -0.09109769, -0.09109769, -0.3472757, 0.12828282, 3.0042384, -0.08764314, 0.12816122, -4.8822327, -0.2138357, -4.8901033, -0.24137631, -0.006140007, 4.88925, 10.564334, 4.6637383, 14.161647, 5.309107, 5.7518725, 0.25314623, 5.3931327, 2.5284367, 3.8776443, 7.9951396, -0.1833188, -0.090475276, -0.090475276, -0.49794924, 3.7097373, -0.16749138, 1.1733439, 3.7013984, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 0.98037815, 6.721345, 2.8438532, 16.923056, 7.7982855, 0.11531869, 10.477364, 4.159453, 3.4484744, 5.2396917, 1.111812, -0.08933249, -0.08933249, 1.912828, 19.514044, 4.625983, 39.2383, 19.516558, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, -4.880319, 0.61236864, 0.02445093, 0.9379909, 0.31222126, 0.34252068, -0.0062693693, -0.120284535, 0.11003265, 0.4442844, -0.25479236, -0.1833188, -0.09014877, -0.09014877, -0.49794924, 0.32765707, 10.790047, 0.019577287, 0.3275626, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.8887825, 1.4320006, 3.5560524, 2.3156483, 5.1105, 3.8441505, -0.021199508, 3.4793892, 2.0363195, 3.8776443, 5.2140174, -0.07443614, -0.054538786, -0.054538786, -0.49794924, 5.795421, 1.9493872, 2.8702273, 5.7836194, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, 4.888803, 0.09251254, 0.6290269, 0.21518421, 1.1095155, 1.76793, -0.015863683, 0.23915628, 0.011609232, 3.8776443, 0.64434487, -0.1833188, -0.09073036, -0.09073036, 0.4060922, 1.034808, 0.9949977, 0.08675458, 1.0765846, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, 4.889052, 0.17002858, 2.898131, 0.36036333, 5.309107, 4.445282, 0.0013560682, 2.5146527, 0.053790696, 3.8776443, 3.9250774, -0.29793212, -0.0908324, -0.0908324, -0.49794924, 6.12696, 1.6623528, 3.2206328, 6.1149516, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007, 4.889181, 11.492178, 6.8070974, 15.736995, 24.66569, 12.989457, 0.3035543, 10.150657, 3.4704895, 3.8776443, 14.80958, -0.1833188, -0.09051609, -0.09051609, -0.49794924, 22.381039, 4.625983, 41.895283, 22.358137, 4.885499, -0.2138357, 4.893243, 4.1429086, -0.006140007, -4.880319, 1.9433872, -0.012658947, 3.3597023, -0.03305002, -0.016833143, 0.14992128, -0.16001096, 1.9378961, 1.7317944, -0.2972625, -0.1833188, -0.09074057, -0.09074057, 1.3101336, 0.0077900398, 9.778251, -0.08988129, 0.007652076, -4.8822327, -0.2138357, -4.8901033, 4.1429086, -0.006140007, 4.889219, -0.16157712, 1.5117147, -0.087529704, 5.309107, 0.68448645, -0.00203645, 0.90188915, -0.04463272, 3.8776443, 1.5046632, -0.25208676, -0.08817951, -0.08817951, 1.912828, 4.380224, -0.19619493, 1.6396316, 4.3713813, 4.885499, -0.2138357, 4.893243, -0.24137631, -0.006140007};
};

/**
 * @brief               Empty constructor for Detectors class.
*/
Detectors::Detectors() {
}

/**
 * @brief               Destructor for Detectors class. Sets num_detectors = num_features = 0.
*/
Detectors::~Detectors() {
    num_detectors = 0;
    num_features = 0;
}

/**
 * @brief               Read one feature value from one detector.
 * @param detector      Index of detector. Range: 0 to num_detectors - 1.
 * @param feature       Index of feature. Range: 0 to num_features - 1.
 * @returns             Float of feature
*/
float Detectors::get(short detector, short feature) {
    return detectorsArray_[detector*num_features + feature];
}

/**
 * @brief               Scales all features of incoming network request. Modelled after sklearn StandardScaler().
 * @param request       Array of features of incoming network request.
 * @param cap           Capacity of network request feature array.
 * @returns             Scaled features array
*/
float* scaler(float request[], short cap) {

    // Hardcoded Mean and Standard Deviation
    // Get from StandardScaler() in Kaggle notebook
    double mean{8.3186720e+07};
    double std_dev{2.9054373e+14};

    for (short i{0}; i < cap; i++) {
        request[i] = (request[i] - ((float) mean))/ ((float) std_dev);
    }

    return request;
}


/**
 * @brief              Absolute value function
*/
float abs(float x) {
    if (x < 0) {
        return -x;
    }
    return x;
}

/**
 * @brief               Predicts if cyberattack or benign
 * @param attack        Feature array from incoming network request
 * @param D             Class holding detectors
 * @returns             True if Attack
*/
bool psa(float attack[], Detectors D) {
    float r{3.5}; //Hardcoded radius value
    float dist{0.0};
    
    float* scaled_attack = scaler(attack, D.get_num_feats());
    for (unsigned int d{0}; d < D.get_num_dtrs(); d++) {
        dist = 0.0;
        for (short f{0}; f < D.get_num_feats(); f++) {
            dist += abs(scaled_attack[f] - D.get(d, f));
        }
        if (dist < r) {
            return false;
        }
    }

    return true;
}

/**
 * @brief               Tests PSA on dummy attack vector
*/
int main() {

    while (true) {
        Detectors D;    
    
        float dummy_attack_vector[24];
        for (short i{0}; i < D.get_num_feats(); i++) {
            dummy_attack_vector[i] = (float) i;
        }

        bool is_attack = psa(dummy_attack_vector, D);

    }

    return 0;
}